<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Gen-Drive: Diffusion Generative Driving Policy">
  <meta name="keywords" content="Autonomous Driving, Diffusion Policy, Reward Learning, Reinforcement Learning">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Gen-Drive: Generative Driving Policy</title>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/robot.png">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://github.com/MCZhi/DTPP">
            DTPP
          </a>
          <a class="navbar-item" href="https://mczhi.github.io/GameFormer">
            GameFormer
          </a>
          <a class="navbar-item" href="https://mczhi.github.io/DIPP">
            DIPP
          </a>
          <a class="navbar-item" href="https://sites.google.com/view/versatile-behavior-diffusion">
            VBD
          </a>
        </div>
      </div>
    </div>

  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Gen-Drive: Enhancing Diffusion Generative Driving Policies with Reward Modeling and Reinforcement Learning Fine-tuning</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://mczhi.github.io">Zhiyu Huang</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://research.nvidia.com/person/xinshuo-weng">Xinshuo Weng</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://maximilianigl.com/">Maximilian Igl</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://research.nvidia.com/person/yuxiao-chen">Yuxiao Chen</a><sup>2</sup>,
            </span>
            
            <span class="author-block">
              <a href="https://kikacaty.github.io/">Yulong Cao</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.borisivanovic.com/">Boris Ivanovic</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://research.nvidia.com/person/marco-pavone">Marco Pavone</a><sup>2,3</sup>
            </span>
            <span class="author-block">
              <a href="https://lvchen.wixsite.com/automan">Chen Lyu</a><sup>1</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Nanyang Technological University</span>
            <span class="author-block"><sup>2</sup>NVIDIA Research</span>
            <span class="author-block"><sup>3</sup>Stanford University</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <!-- <span class="link-block">
                <a href="https://arxiv.org/abs/2410.05582"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span> -->
              <span class="link-block">
                <a href="https://arxiv.org/abs/2011.12948"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/mczhi/gen-drive"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code (Comming Soon)</span>
                  </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <img src="./static/images/GenDrive.png" alt="Gen-Drive Introduction" style="width: 100%;">
      <h2 class="subtitle has-text-centered">
        <span class="dnerf">Gen-Drive</span> represents a paradigm shift from conventional prediction-deterministic-planning approaches to a generation-then-evaluation framework.
      </h2>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Autonomous driving necessitates the ability to reason about future interactions between traffic agents and to make informed evaluations for planning.
            This paper introduces the <span class="dnerf">Gen-Drive</span> framework, which shifts from the traditional prediction and deterministic planning framework to a generation-then-evaluation planning paradigm.
          <p>
            The framework employs a behavior diffusion model as a scene generator to produce diverse possible future scenarios, thereby enhancing the capability for joint interaction reasoning. 
            To facilitate decision-making, we propose a scene evaluator (reward) model, trained with pairwise preference data collected through VLM assistance, thereby reducing human workload and enhancing scalability.
            Furthermore, we utilize an RL fine-tuning framework to improve the generation quality of the diffusion model, rendering it more effective for planning tasks.
          </p>
          <p>
            We conduct training and closed-loop planning tests on the nuPlan dataset, and the results demonstrate that employing such a generation-then-evaluation strategy outperforms other learning-based approaches. 
            Additionally, the fine-tuned generative driving policy shows significant enhancements in planning performance. 
            We further demonstrate that utilizing our learned reward model for evaluation or RL fine-tuning leads to better planning performance compared to relying on human-designed rewards.
          </p>
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Paper video.  -->
    <!-- <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video</h2>
        <div class="publication-video">
          <iframe src="https://www.youtube.com/embed/MrKrnHhk8IA?rel=0&amp;showinfo=0"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div> -->
    <!--/ Paper video. -->
  <!-- </div>   -->
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- System Pipeline. -->
    <div class="columns is-centered has-text-centered">
      <div class="column">
        <h2 class="title is-3">Model Structure</h2>
        <div class="content has-text-justified">
          <img src="./static/images/GenDriveModel.png" alt="Neural Network Structure of the Gen-Drive Model" style="width: 100%;">
          <p>
            The query-centric encoding Transformer encodes all scene elements in local coordinates while preserving relative information in attention calculations.
            The diffusion denoising Transformer comprises multiple attention blocks that iteratively attend to noised object futures, future-scene, and ego-route interactions.
          </p>
          <p>
            During diffusion generation, different scenes can be produced in parallel and then be fed into the scene evaluation Transformer.
            The evaluation model utilizes a Transformer encoder-decoder to fuse information from the future scene and map, and two MLP heads are used to reconstruct the ego plan and output a score for the scene/plan.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Reward Pipeline. -->
    <div class="columns is-centered has-text-centered">
      <div class="column">
        <h2 class="title is-3">Pairwise Preference from AI Feedback</h2>
        <div class="content has-text-justified">
          <img src="./static/images/gpt_prompt.png" alt="Prompt to GPT-4o and its feedback" style="width: 100%;">
          <p>
            We conduct pairwise sampling of the generated scenarios from the base diffusion generator. We first compute discrepancies between the planned trajectories, and then check collisions and off-road to filter out obvious failure cases.
          </p>
          <p>
            If these measures are insufficient for distinction, we utilize GPT-4o to provide a conclusive evaluation. GPT-4o can provide reasonable evaluations of the two generated scenarios based on the current scene context.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section" id="Results">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column">
        <h2 class="title is-3">Closed-loop Planning Results</h2>
      </div>
    </div>

    <!-- First row -->
    <div class="columns is-centered">  
      <div class="column has-text-centered">
        <div class="content">
          <h3 class="title is-4">Single-Sample Planning</h3>
          <p>
            Single-sample planning often results in suboptimal performance due to a lack of diversity in the plans.
          </p>
          <video id="dollyzoom" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/single/traversing_pickup_dropoff_Gen-Drive Planner_a5189e52ecf55b73.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>

      <div class="column has-text-centered">
        <h3 class="title is-4">Multi-Sample and Scoring</h3>
        <div class="columns is-centered">
          <div class="column content">
            <p>
               Multiple-sample planning increases the diversity and the learned reward model helps make the right decision.
            </p>
            <video id="matting-video" autoplay controls muted loop playsinline height="100%">
              <source src="./static/videos/multi/traversing_pickup_dropoff_Gen-Drive Planner_a5189e52ecf55b73.mp4"
                      type="video/mp4">
            </video>
          </div>
        </div>
      </div>
    </div>

    <!-- Second row -->
    <div class="columns is-centered">  
      <div class="column has-text-centered">
        <div class="content">
          <h3 class="title is-4">Single-Sample Planning</h3>
          <video id="video1" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/single/waiting_for_pedestrian_to_cross_Gen-Drive Planner_f7da2c3fd6f05e84.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>

      <div class="column has-text-centered">
        <h3 class="title is-4">Multi-Sample and Scoring</h3>
        <div class="columns is-centered">
          <div class="column content">
            <video id="rendering-video" autoplay controls muted loop playsinline height="100%">
              <source src="./static/videos/multi/waiting_for_pedestrian_to_cross_Gen-Drive Planner_f7da2c3fd6f05e84.mp4"
                      type="video/mp4">
            </video>
          </div>
        </div>
      </div>
    </div>

    <!-- Third row -->
    <div class="columns is-centered">  
      <div class="column has-text-centered">
        <div class="content">
          <h3 class="title is-4">Before Fine-tuning</h3>
          <p>
            The base diffusion driving policy can exhibit undesirable behaviors in certain scenarios due to the limitations inherent in imitation learning. 
          </p>
          <video id="multisample" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/multi/high_lateral_acceleration_Gen-Drive Planner_41d071d979345e7d.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>

      <div class="column has-text-centered">
        <h3 class="title is-4">After Fine-tuning</h3>
        <div class="columns is-centered">
          <div class="column content">
            <p>
              Fine-tuning the diffusion policy leads to substantial improvements in closed-loop planning in some challenging situations.
            </p>
            <video id="dynamic-scene" autoplay controls muted loop playsinline height="100%">
              <source src="./static/videos/tuned/high_lateral_acceleration_Gen-Drive Planner_41d071d979345e7d.mp4"
                      type="video/mp4">
            </video>
          </div>
        </div>
      </div>
    </div>

    <!-- Fourth row -->
    <div class="columns is-centered">  
      <div class="column has-text-centered">
        <div class="content">
          <h3 class="title is-4">Before Fine-tuning</h3>
          <video id="path-planning" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/multi/high_lateral_acceleration_Gen-Drive Planner_875e1631b9095dc9.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>

      <div class="column has-text-centered">
        <h3 class="title is-4">After Fine-tuning</h3>
        <div class="columns is-centered">
          <div class="column content">
            <video id="object-detection" autoplay controls muted loop playsinline height="100%">
              <source src="./static/videos/tuned/high_lateral_acceleration_Gen-Drive Planner_875e1631b9095dc9.mp4"
                      type="video/mp4">
            </video>
          </div>
        </div>
      </div>
    </div>

    <!-- Fifth row -->
    <div class="columns is-centered">  
      <div class="column has-text-centered">
        <div class="content">
          <h3 class="title is-4">Before Fine-tuning</h3>
          <video id="trajectory-planning" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/single/high_lateral_acceleration_Gen-Drive Planner_d9ec238b65cb5bda.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>

      <div class="column has-text-centered">
        <h3 class="title is-4">After Fine-tuning</h3>
        <div class="columns is-centered">
          <div class="column content">
            <video id="collision-avoidance" autoplay controls muted loop playsinline height="100%">
              <source src="./static/videos/tuned/high_lateral_acceleration_Gen-Drive Planner_d9ec238b65cb5bda.mp4"
                      type="video/mp4">
            </video>
          </div>
        </div>
      </div>
    </div>

    <!-- Sixth row -->
    <div class="columns is-centered">  
      <div class="column has-text-centered">
        <div class="content">
          <h3 class="title is-4">PDM-Closed Planner</h3>
          <p>
            Rule-based planners often exhibit unnatural behaviors and are unable to handle more complex driving tasks in real-world scenarios.
          </p>
          <video id="ai-control" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/pdm/waiting_for_pedestrian_to_cross_PDMClosedPlanner_4064de4004385810.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>

      <div class="column has-text-centered">
        <h3 class="title is-4">Gen-Drive Planner</h3>
        <div class="columns is-centered">
          <div class="column content">
            <p>
              Our Gen-Drive planner shows nuanced driving behaviors across various situations, exhibiting human-like planning and adaptability.
            </p>
            <video id="vision-navigation" autoplay controls muted loop playsinline height="100%">
              <source src="./static/videos/multi/waiting_for_pedestrian_to_cross_Gen-Drive Planner_4064de4004385810.mp4"
                      type="video/mp4">
            </video>
          </div>
        </div>
      </div>
    </div>

    <!-- Seventh row -->
    <div class="columns is-centered">  
      <div class="column has-text-centered">
        <div class="content">
          <h3 class="title is-4">PDM-Closed Planner</h3>
          <video id="ai-control" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/pdm/changing_lane_PDMClosedPlanner_1d68dfeb693b526b.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>

      <div class="column has-text-centered">
        <h3 class="title is-4">Gen-Drive Planner</h3>
        <div class="columns is-centered">
          <div class="column content">
            <video id="vision-navigation" autoplay controls muted loop playsinline height="100%">
              <source src="./static/videos/tuned/changing_lane_Gen-Drive Planner_1d68dfeb693b526b.mp4"
                      type="video/mp4">
            </video>
          </div>
        </div>
      </div>
    </div>

    <!-- Eighth row -->
    <div class="columns is-centered">  
      <div class="column has-text-centered">
        <div class="content">
          <h3 class="title is-4">PDM-Closed Planner</h3>
          <video id="ai-control" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/pdm/traversing_pickup_dropoff_PDMClosedPlanner_f6804d2da7c7505a.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>

      <div class="column has-text-centered">
        <h3 class="title is-4">Gen-Drive Planner</h3>
        <div class="columns is-centered">
          <div class="column content">
            <video id="vision-navigation" autoplay controls muted loop playsinline height="100%">
              <source src="./static/videos/multi/traversing_pickup_dropoff_Gen-Drive Planner_f6804d2da7c7505a.mp4"
                      type="video/mp4">
            </video>
          </div>
        </div>
      </div>
    </div>

  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{huang2024gendrive,
  title={Gen-Drive: Enhancing Diffusion Generative Driving Policies with Reward Modeling and Reinforcement Learning Fine-tuning},
  author={Zhiyu Huang and Xinshuo Weng and Maximilian Igl and Yuxiao Chen and Yulong Cao and Boris Ivanovic and Marco Pavone and Chen Lv},
  journal={arXiv preprint arXiv:2410.05582},
  year={2024},
  url={https://arxiv.org/abs/2410.05582}
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
